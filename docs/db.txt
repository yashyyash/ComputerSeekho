-- Creates the 'courses' table
CREATE TABLE `courses` (
  `course_id` int NOT NULL AUTO_INCREMENT,
  `course_name` varchar(255) DEFAULT NULL,
  `course_code` varchar(255) DEFAULT NULL,
  `description` varchar(255) DEFAULT NULL,
  `duration` varchar(255) DEFAULT NULL,
  `total_fee` int NOT NULL,
  `is_active` tinyint(1) DEFAULT '1',
  `syllabus` varchar(255) DEFAULT NULL,
  `age_group` varchar(255) DEFAULT NULL,
  `cover_photo_url` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`course_id`),
  UNIQUE KEY `course_name` (`course_name`),
  UNIQUE KEY `course_code` (`course_code`)
);

-- Creates the 'staff' table
CREATE TABLE `staff` (
  `staff_id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(50) NOT NULL,
  `password_hash` varchar(255) NOT NULL,
  `first_name` varchar(100) NOT NULL,
  `last_name` varchar(100) NOT NULL,
  `email` varchar(100) NOT NULL,
  `role` enum('Admin','Counselor') NOT NULL,
  `is_active` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`staff_id`),
  UNIQUE KEY `username` (`username`),
  UNIQUE KEY `email` (`email`)
);

-- Creates the 'inquiries' table
CREATE TABLE `inquiries` (
  `inquiry_id` int NOT NULL AUTO_INCREMENT,
  `first_name` varchar(100) NOT NULL,
  `last_name` varchar(100) DEFAULT NULL,
  `phone_number` varchar(15) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `inquired_course_id` int DEFAULT NULL,
  `inquiry_source` enum('Telephonic','Walk-in','eMail','Online','Fax') DEFAULT NULL,
  `inquiry_date` date DEFAULT NULL,
  `assigned_to_staff_id` int DEFAULT NULL,
  `status` enum('Open','Closed','Registered') DEFAULT NULL,
  `next_follow_up_date` date DEFAULT NULL,
  `remarks` text,
  `closure_reason` text,
  PRIMARY KEY (`inquiry_id`)
);

-- Creates the 'students' table
CREATE TABLE `students` (
  `student_id` int NOT NULL AUTO_INCREMENT,
  `inquiry_id` int DEFAULT NULL,
  `first_name` varchar(100) DEFAULT NULL,
  `last_name` varchar(100) DEFAULT NULL,
  `phone_number` varchar(15) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `date_of_birth` date DEFAULT NULL,
  `address` text,
  `photo_url` varchar(255) DEFAULT NULL,
  `enrollment_date` date DEFAULT NULL,
  PRIMARY KEY (`student_id`),
  UNIQUE KEY `inquiry_id` (`inquiry_id`)
);

-- Creates the 'followups' table
CREATE TABLE `followups` (
  `follow_up_id` int NOT NULL AUTO_INCREMENT,
  `inquiry_id` int DEFAULT NULL,
  `follow_up_by_staff_id` int DEFAULT NULL,
  `follow_up_date` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `remarks` text,
  `next_follow_up_date_set` date DEFAULT NULL,
  PRIMARY KEY (`follow_up_id`)
);

-- Creates the 'registrations' table
CREATE TABLE `registrations` (
  `registration_id` int NOT NULL AUTO_INCREMENT,
  `student_id` int DEFAULT NULL,
  `course_id` int DEFAULT NULL,
  `registration_date` date DEFAULT NULL,
  `total_fee` decimal(10,2) DEFAULT NULL,
  `discount_amount` decimal(10,2) DEFAULT '0.00',
  `final_amount` decimal(10,2) DEFAULT NULL,
  PRIMARY KEY (`registration_id`)
);

-- Creates the 'payments' table
CREATE TABLE `payments` (
  `payment_id` int NOT NULL AUTO_INCREMENT,
  `registration_id` int DEFAULT NULL,
  `amount_paid` decimal(10,2) DEFAULT NULL,
  `payment_date` date DEFAULT NULL,
  `payment_mode` enum('Cash','Card','UPI','Bank Transfer') DEFAULT NULL,
  `receipt_number` varchar(50) DEFAULT NULL,
  `processed_by_staff_id` int DEFAULT NULL,
  PRIMARY KEY (`payment_id`),
  UNIQUE KEY `receipt_number` (`receipt_number`)
);

-- Creates the 'batch_placement_master' table
CREATE TABLE `batch_placement_master` (
  `batch_id` int NOT NULL AUTO_INCREMENT,
  `batch_name` varchar(255) DEFAULT NULL,
  `placement_percentage` double NOT NULL,
  `batch_logo_url` varchar(255) DEFAULT NULL,
  `is_active` tinyint(1) DEFAULT '1',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`batch_id`)
);

-- Creates the 'recruiters' table
CREATE TABLE `recruiters` (
  `recruiter_id` int NOT NULL AUTO_INCREMENT,
  `company_name` varchar(100) NOT NULL,
  `contact_person` varchar(100) DEFAULT NULL,
  `contact_email` varchar(100) DEFAULT NULL,
  `website` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`recruiter_id`)
);


-- Adding Foreign Keys to 'inquiries' table
ALTER TABLE `inquiries`
  ADD KEY `inquiries_fk_course` (`inquired_course_id`),
  ADD KEY `inquiries_fk_staff` (`assigned_to_staff_id`),
  ADD CONSTRAINT `inquiries_fk_course` FOREIGN KEY (`inquired_course_id`) REFERENCES `courses` (`course_id`),
  ADD CONSTRAINT `inquiries_fk_staff` FOREIGN KEY (`assigned_to_staff_id`) REFERENCES `staff` (`staff_id`);

-- Adding Foreign Key to 'students' table
ALTER TABLE `students`
  ADD CONSTRAINT `students_fk_inquiry` FOREIGN KEY (`inquiry_id`) REFERENCES `inquiries` (`inquiry_id`);

-- Adding Foreign Keys to 'followups' table
ALTER TABLE `followups`
  ADD KEY `followups_fk_inquiry` (`inquiry_id`),
  ADD KEY `followups_fk_staff` (`follow_up_by_staff_id`),
  ADD CONSTRAINT `followups_fk_inquiry` FOREIGN KEY (`inquiry_id`) REFERENCES `inquiries` (`inquiry_id`),
  ADD CONSTRAINT `followups_fk_staff` FOREIGN KEY (`follow_up_by_staff_id`) REFERENCES `staff` (`staff_id`);

-- Adding Foreign Keys to 'registrations' table
ALTER TABLE `registrations`
  ADD KEY `registrations_fk_student` (`student_id`),
  ADD KEY `registrations_fk_course` (`course_id`),
  ADD CONSTRAINT `registrations_fk_student` FOREIGN KEY (`student_id`) REFERENCES `students` (`student_id`),
  ADD CONSTRAINT `registrations_fk_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`course_id`);

-- Adding Foreign Keys to 'payments' table
ALTER TABLE `payments`
  ADD KEY `payments_fk_registration` (`registration_id`),
  ADD KEY `payments_fk_staff` (`processed_by_staff_id`),
  ADD CONSTRAINT `payments_fk_registration` FOREIGN KEY (`registration_id`) REFERENCES `registrations` (`registration_id`),
  ADD CONSTRAINT `payments_fk_staff` FOREIGN KEY (`processed_by_staff_id`) REFERENCES `staff` (`staff_id`);


  -- Data for 'courses' table
INSERT INTO `courses` (`course_id`, `course_name`, `course_code`, `description`, `duration`, `total_fee`, `is_active`, `syllabus`, `age_group`, `cover_photo_url`) VALUES
(1, 'PGDAC', '1', 'ADVANCE COMPUTING COURSE', '6 MONTH', 160000, 1, 'c++ dsa dbms os java javaadv wpt', '21', 'courses/dac.png'),
(2, 'PGDBDA', '2', 'ADVANCE DATA ANALYTICS COURSE', '6 MONTHS', 125000, 1, 'aws python java', '20', 'courses/dbda.png'),
(3, 'MSCIT', '3', 'BASIC COMPUTERS', '3 MONTH', 25000, 1, 'ms office', NULL, 'courses/mscit.png'),
(4, 'FUNDAMENTAL COMPUTER', '4', 'COURSE', '1 MONTH', 10000, 1, 'aws', '5', 'https://mscit.mkcl.org/user/pages/01.home/_slider/MS-CIT%20Web%20Banner%202025-min_7.jpg');

-- Data for 'staff' table
INSERT INTO `staff` (`staff_id`, `username`, `password_hash`, `first_name`, `last_name`, `email`, `role`, `is_active`) VALUES
(1, 'admin_user', '$2a$10$AbcdEfghIjklmnopqrstuv', 'Amit', 'Patil', 'amit.patil@example.com', 'Admin', 1),
(2, 'counselor_jyoti', '$2a$10$XyZ1234567passwordhashed', 'Jyoti', 'Kale', 'jyoti.kale@example.com', 'Counselor', 1),
(3, 'counselor_rahul', '$2a$10$zxcvbnmlkjhgfdsa1234567', 'Rahul', 'Sharma', 'rahul.sharma@example.com', 'Counselor', 1);

-- Data for 'inquiries' table
INSERT INTO `inquiries` (`inquiry_id`, `first_name`, `last_name`, `phone_number`, `email`, `inquired_course_id`, `inquiry_source`, `inquiry_date`, `assigned_to_staff_id`, `status`, `next_follow_up_date`, `remarks`, `closure_reason`) VALUES
(1, 'Amit', 'Verma', '9876543210', 'amit.verma@example.com', 1, 'Walk-in', '2025-07-25', 1, 'Open', '2025-08-01', 'Interested in PG-DAC, wants EMI option.', NULL),
(2, 'Sneha', 'Patil', '9876501234', 'sneha.patil@example.com', 2, 'Online', '2025-07-27', 2, 'Registered', NULL, 'Directly enrolled after inquiry.', NULL),
(3, 'Rahul', 'Joshi', '9867123456', 'rahul.joshi@example.com', 3, 'Telephonic', '2025-07-20', 1, 'Closed', NULL, 'Wants evening batch, not available.', 'Requested weekend batch, unavailable.'),
(4, 'Priya', 'Sharma', '9854321987', 'priya.sharma@example.com', 4, 'eMail', '2025-07-18', 3, 'Open', '2025-07-30', 'Looking for short-term skill development.', NULL),
(5, 'Deepak', 'Kumar', '9832123456', 'deepak.kumar@example.com', 2, 'Walk-in', '2025-07-26', 1, 'Open', '2025-08-05', 'Good technical background. Follow up for scholarship info.', NULL);

-- Data for 'students' table
INSERT INTO `students` (`student_id`, `inquiry_id`, `first_name`, `last_name`, `phone_number`, `email`, `date_of_birth`, `address`, `photo_url`, `enrollment_date`) VALUES
(1, 2, 'Sneha', 'Patil', '9876501234', 'sneha.patil@example.com', '2000-06-15', 'Pune, MH', '/images/students/sneha.jpg', '2025-07-28'),
(2, 1, 'Amit', 'Verma', '9876543210', 'amit.verma@example.com', '1999-11-23', 'Mumbai, MH', '/images/students/amit.jpg', '2025-07-30');

-- Data for 'followups' table
INSERT INTO `followups` (`follow_up_id`, `inquiry_id`, `follow_up_by_staff_id`, `follow_up_date`, `remarks`, `next_follow_up_date_set`) VALUES
(1, 1, 1, '2025-07-26 10:30:00', 'Explained course syllabus in detail.', '2025-08-01'),
(2, 2, 2, '2025-07-27 11:00:00', 'Sent registration documents by email.', NULL),
(3, 3, 1, '2025-07-21 09:45:00', 'Followed up but student not interested now.', NULL),
(4, 4, 3, '2025-07-19 15:20:00', 'Explained short-term course options.', '2025-07-30'),
(5, 5, 1, '2025-07-26 16:10:00', 'Requested details on scholarships.', '2025-08-05');

-- Data for 'registrations' table
INSERT INTO `registrations` (`registration_id`, `student_id`, `course_id`, `registration_date`, `total_fee`, `discount_amount`, `final_amount`) VALUES
(1, 1, 2, '2025-07-28', 125000.00, 5000.00, 120000.00),
(2, 2, 1, '2025-07-30', 160000.00, 10000.00, 150000.00);

-- Data for 'payments' table
INSERT INTO `payments` (`payment_id`, `registration_id`, `amount_paid`, `payment_date`, `payment_mode`, `receipt_number`, `processed_by_staff_id`) VALUES
(1, 1, 60000.00, '2025-07-28', 'UPI', 'RCPT1001', 2),
(2, 1, 60000.00, '2025-08-05', 'Card', 'RCPT1002', 2),
(3, 2, 75000.00, '2025-07-30', 'Bank Transfer', 'RCPT1003', 1);

-- Data for 'batch_placement_master' table
INSERT INTO `batch_placement_master` (`batch_id`, `batch_name`, `placement_percentage`, `batch_logo_url`, `is_active`, `created_at`) VALUES
(1, 'PG DAC March 2024', 79, '/public/batchwisePlacement/dac_March24.jpg', 1, '2025-07-28 12:18:28'),
(2, 'PG DAC Sept 2023', 70, '/public/batchwisePlacement/dac_Sept23.jpg', 1, '2025-07-28 12:18:28'),
(3, 'PG DAC March 2023', 67, '/public/batchwisePlacement/dac_march23.png', 1, '2025-07-28 12:18:28'),
(4, 'PG DAC Sept 2022', 70, '/public/batchwisePlacement/dac_sept22.png', 1, '2025-07-28 12:18:28'),
(5, 'DAC March 2022', 90, '/public/batchwisePlacement/DAC_march22.png', 1, '2025-07-28 12:18:28'),
(6, 'e-DAC Sept 2021', 100, '/public/batchwisePlacement/dac_sept21.png', 1, '2025-07-28 12:18:28'),
(7, 'e-DAC May 2021', 100, '/public/batchwisePlacement/DAC_may21.png', 1, '2025-07-28 12:18:28'),
(8, 'e-DAC Sep 2020', 100, '/public/batchwisePlacement/DAC_sep20.png', 1, '2025-07-28 12:18:28'),
(9, 'PG-DAC Feb 2020', 100, '/public/batchwisePlacement/DAC_feb20.png', 1, '2025-07-28 12:18:28'),
(10, 'PG-DAC Feb 2020', 90, '/public/batchwisePlacement/dac_aug19.png', 1, '2025-07-28 12:18:28'),
(11, 'PG-DAC Aug 2019', 90, '/public/batchwisePlacement/dac_aug19.png', 1, '2025-07-28 12:18:28'),
(12, 'PG-DAC Feb 2019', 100, '/public/batchwisePlacement/feb19.png', 1, '2025-07-28 12:18:28'),
(13, 'PG-DAC Aug 2018', 100, '/public/batchwisePlacement/aug18.png', 1, '2025-07-28 12:18:28'),
(14, 'PG-DAC Feb 2018', 100, '/public/batchwisePlacement/feb18.png', 1, '2025-07-28 12:18:28'),
(15, 'PG-DAC Aug 2017', 98, '/public/batchwisePlacement/aug17.png', 1, '2025-07-28 12:18:28'),
(16, 'PG-DAC Feb 2017', 97, '/public/batchwisePlacement/feb17.png', 1, '2025-07-28 12:18:28'),
(17, 'PG-DAC Aug 2016', 100, '/public/batchwisePlacement/aug16.png', 1, '2025-07-28 12:18:28'),
(18, 'PG-DAC Feb 2016', 97, '/public/batchwisePlacement/feb16.png', 1, '2025-07-28 12:18:28'),
(19, 'PG-DAC Aug 2015', 100, '/public/batchwisePlacement/aug15.png', 1, '2025-07-28 12:18:28'),
(20, 'PG-DAC Feb 2015', 100, '/public/batchwisePlacement/feb15.png', 1, '2025-07-28 12:18:28');

-- Data for 'recruiters' table
INSERT INTO `recruiters` (`recruiter_id`, `company_name`, `contact_person`, `contact_email`, `website`) VALUES
(1, 'Tata Consultancy Services', 'Anita Desai', 'anita.desai@tcs.com', 'https://www.tcs.com'),
(2, 'Infosys', 'Raj Malhotra', 'raj.malhotra@infosys.com', 'https://www.infosys.com'),
(3, 'Wipro Technologies', 'Neha Sharma', 'neha.sharma@wipro.com', 'https://www.wipro.com'),
(4, 'Cognizant', 'Vikram Rao', 'vikram.rao@cognizant.com', 'https://www.cognizant.com'),
(5, 'Capgemini India', 'Sneha Patil', 'sneha.patil@capgemini.com', 'https://www.capgemini.com');

